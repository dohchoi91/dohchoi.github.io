---
title: "01.도메인 모델 시작"
subtitle: "도메인 모델 시작"
permalink: /notes/ddd-start/ch01
author_profile: true
date: 2021-04-05 13:50
categories:
  - DDD START
tags:
  - java
last_modified_at: 2021-04-05 13:50
---

## 도메인

- 소프트웨어로 해결하고자하는 문제 영역
- 도메인은 다시 하위 도메인으로 나눌 수 있다.

## 도메인 모델

- 도메인 자체를 이해하기 위한 개념 모델.
- 특정 도메인을 개념적으로 표현
- 객체, 상태 등 다양한 방법으로 모델링이 가능하다.

### 하위 도메인과 모델

> 각 하위 도메인이 다루는 영역은 서로 다르기 때문에 같은 용어라도 하위 도메인 마다 의미가 달라 질 수 있다. 도메인에 따라 용어의 의미가 결정되므로, 여러 하위 도메인을 하나의 다이어그램에 모델링하면 안된다. 모델의 각 구성요소는 특정 도메인을 한정할 때 비로소 의미가 완전해지기 때문에, 각 하위 도메인 마다 별도로 모델을 만들어야 한다.

## 도메인 모델 패턴

### 일반적인 애플리케이션 아키텍쳐

1. **사용자 인터페이스(UI), 표현 계층(Presentation)**
사용자의 요청을 처리하고 사용자에게 정보를 보여준다. 여기서 사용자는 소프트웨어를 사용하는 사람 뿐만 아니라 외부 시스템도 사용자가 될 수 있다.
2. **응용(Application)**
사용자가 요청한 기능을 실행한다. 업무 로직을 직접 구현하지 않으며 도메인 계층을 조합해서 기능을 실행한다.
3. **도메인**
시스템이 제공할 도메인의 규칙을 구현한다.
4. **인프라스트럭처**
데이터베이스나 메시징 시스템과 같은 외부 시스템과의 연동을 처리한다.

### 개념모델과 구현 모델

> 개념 모델은 순수하게 문제를 분석한 결과물이다. 개념 모델은 데이터베이스, 트랜잭션 처리, 성능, 구현 기술과 같은 것들을 고려하지 않기 때문에 실제 코드를 작성할 때 개념 모델을 있는 그대로 사용 할 수 없다. 그래서 개념 모델을 구현 가능한 형태의 모델로 전환하는 과정을 거치게 된다.
**따라서, 처음부터 완벽한 개념 모델을 만들기 보다는 전반적인 개요를 알 수 있는 수준으로 개념 모델을 작성해야 한다.** 프로젝 초기에는 개념 모델로 도메인 에 대한 전체 윤곽을 이해하는 데 집중하고, 구현하는 과정에서 개념 모델을 구현 모델로 점진적으로 발전 시켜 나가야한다.

## 도메인 모델 도출

기획서, 유스케이스, 사용자 스토리와 같은 요구사항과 관련자와의 대화를 통해 도메인을 이해하고, 이를 바탕으로 초안을 만들어야 비로소 코드를 작성 할 수 있다.

도메인 모델링 할때 기본작업 모델을 구성하는 핵심 구성요소, 규칙, 기능을 찾는 것이다. 

### 문서화

> 문서화를 하는 주된 이유는 지식을 공유하기 위함이다. 전반적인 기능 목록이나 모듈 구조, 빌드 과정을 코드를 보고 직접 이해하는 것보다 상위 수준에서 정리한 문서를 참조하는 것이 소프트웨어 전반을 빠르게 이해하는 데 도움이 된다.

## 엔티티와 밸류

엔티티와 밸류를 제대로 구분해야 도메인을 올바르게 설계하고 구현 할 수있다.

### 엔티티

가장 큰 특징은 **식별자**를 갖는다는 것이다.

엔티티의 식별자를 생성하는 시점은 도메인인의 특징과 사용하는 기술에 따라 달라진다. 흔한 식별자는 다음 중 한 가지 방식으로 생성한다.

- 특정 규칙에 따라 생성
- UUID 사용
- 값을 직접 입력
- 일련번호 사용(시퀀스나 DB의 자동 증가 컬럼)

### 밸류 타입

- 개념적으로 완전한 하나를 표현할 때 사용.

    ```java
    // 서로 다른 두 데이터를 담고 있지만, 개념적으로는 받는 사람을 의미한다.
    public class Receiver {
    	private String name;
    	private String phoneNumber;
    }
    ```

- 반드시 두 개 이상의 데이터를 가져야 하는 것은 아니다. 의미를 명확하게 사용할 경우 사용 할 수 도 있다.
- 엔티티 식별자를 밸류 타입으로 활용 할 수 도 있다.

### 도메인 모델에 set 메서드 넣지 않기

도메인 모델에 get/set 메서드를 무조건 추가하는 것은 좋지 않은 버릇이다. 
특히 set 메서드는 도메인의 핵심 개념이나 의도를 코드에서 사라지게 한다.

> 최근 개발 프레임워크나, 개발 도구는 set메서드가 아닌 private 필드에 직접 값을 할당할 수 있는 기능을 제공한다. 따라서 DTO에서 set메서드를 제공하지 않아도 데이터를 전달 받을수 있다. 이렇게 하면 DTO도 불변 객체가 될 수 있다.

## 도메인 용어

도메인에서 사용하는 용어를 코드에 반영하지 않으면 그 코드는 개발자에게 코드의 의미를 해석해야하는 부담을 준다. 반대로 도메인 용어를 최대한 코드에 반영하면 코드의 가독성을 높여서 코드를 분석하고 이해하는 시간을 절약한다.